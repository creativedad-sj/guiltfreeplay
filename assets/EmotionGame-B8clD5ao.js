import{u as v,r as s,j as e}from"./index-Bz7ikJcQ.js";import{u as C,c as b,d as G,f as g,G as F,F as M,a as T}from"./FeedbackMessage-BJ9LOw3J.js";import{S as I}from"./Stars-CRCi0YeK.js";const O=a=>{const o=[a],i=g.filter(n=>n.id!==a.id).sort(()=>Math.random()-.5),l=Math.min(2,i.length);for(let n=0;n<l;n++)o.push(i[n]);return o.sort(()=>Math.random()-.5)},R=()=>{const{recordAttempt:a}=v(),o=C(),[c,i]=s.useState(null),[l,n]=s.useState([]),[u,h]=s.useState(0),[p,x]=s.useState(0),[t,d]=s.useState({show:!1,type:"",message:""}),[j,w]=s.useState(null),[y,S]=s.useState(!1),k=b("correct"),E=b("wrong"),N=G(),f=s.useCallback(()=>{const m=Math.floor(Math.random()*g.length),r=g[m];i(r),n(O(r)),d({show:!1,type:"",message:""}),o(`Find the ${r.label} face`)},[o]);return s.useEffect(()=>{f()},[f]),{target:c,options:l,score:u,attempts:p,feedback:t,shakeId:j,showStars:y,handleEmotionClick:m=>{x(r=>r+1),m.id===c.id?(h(r=>r+1),S(!0),k?.(),a("emotion-game",!0),o("You got it!"),d({show:!0,type:"success",message:"ðŸ˜Š You got it!"}),setTimeout(()=>{S(!1),f()},1500)):(N(200),E?.(),w(m.id),a("emotion-game",!1),o("Try again"),d({show:!0,type:"error",message:"Not quite..."}),setTimeout(()=>{w(null),d({show:!1,type:"",message:""})},800))},speak:o}};function W(){const{target:a,options:o,score:c,feedback:i,shakeId:l,showStars:n,handleEmotionClick:u,speak:h}=R(),[p,x]=s.useState("portrait");return s.useEffect(()=>{const t=()=>{x(window.innerHeight>window.innerWidth?"portrait":"landscape")};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),e.jsxs(F,{title:"Emotion Game",score:c,children:[e.jsx(M,{feedback:i}),a&&e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("p",{className:"text-text-secondary text-sm mb-1",children:"Find the..."}),e.jsxs("div",{className:"flex items-center justify-center gap-3 bg-gray-100 rounded-full py-2 px-4",children:[e.jsx("span",{className:"text-4xl",children:a.emoji}),e.jsx("span",{className:"text-2xl font-bold text-text-primary",children:a.label}),e.jsx("button",{onClick:()=>h(`Find the ${a.label} face`),className:"w-10 h-10 bg-primary/20 rounded-full flex items-center justify-center text-xl hover:bg-primary/30 transition-colors","aria-label":"Repeat instruction",children:"ðŸ”Š"})]})]}),e.jsx("div",{className:`
        grid gap-3 place-items-center h-full
        ${p==="portrait"?"grid-cols-2 grid-rows-2":"grid-cols-4 grid-rows-1"}
      `,children:o.map(t=>e.jsxs(T,{onClick:()=>u(t),shake:l===t.id,children:[e.jsx("span",{className:"text-7xl",children:t.emoji}),e.jsx("span",{children:t.label})]},t.id))}),n&&e.jsx(I,{})]})}export{W as default};
