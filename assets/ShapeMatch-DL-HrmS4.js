import{u as O,r as a,j as e}from"./index-DweIdlT1.js";import{u as E,c as k,d as F,s as g,G as R,F as $,a as G}from"./FeedbackMessage-hvMpplFp.js";import{S as I}from"./Stars-BHnjPEpD.js";const P=[],z=[],L=s=>{const o=[s],c=g.filter(r=>r.id!==s.id).sort(()=>Math.random()-.5),d=Math.min(3,c.length);for(let r=0;r<d;r++)o.push(c[r]);return o.sort(()=>Math.random()-.5)},A=()=>{const{recordAttempt:s}=O(),o=E(),[l,c]=a.useState(null),[d,r]=a.useState([]),[u,m]=a.useState(0),[p,f]=a.useState(0),[t,h]=a.useState({show:!1,type:"",message:""}),[y,w]=a.useState(null),[b,S]=a.useState(!1),v=k("correct"),M=k("wrong"),C=F(),j=i=>i[Math.floor(Math.random()*i.length)],x=a.useCallback(()=>{const i=Math.floor(Math.random()*g.length),n=g[i];c(n),r(L(n)),h({show:!1,type:"",message:""}),o(`Find the ${n.name}`)},[o]);return a.useEffect(()=>{x()},[x]),{currentShape:l,options:d,score:u,attempts:p,feedback:t,shakeId:y,showStars:b,handleOptionClick:i=>{if(f(n=>n+1),i.id===l.id){const n=j(P);m(N=>N+1),S(!0),v?.(),s("shape-match",!0),o(n),h({show:!0,type:"success",message:n}),setTimeout(()=>{S(!1),x()},1500)}else{const n=j(z);C(200),M?.(),w(i.id),s("shape-match",!1),o(n),h({show:!0,type:"error",message:n}),setTimeout(()=>{w(null),h({show:!1,type:"",message:""})},800)}},speak:o}};function q(){const{currentShape:s,options:o,score:l,feedback:c,shakeId:d,showStars:r,handleOptionClick:u,speak:m}=A(),[p,f]=a.useState("portrait");return a.useEffect(()=>{const t=()=>{f(window.innerHeight>window.innerWidth?"portrait":"landscape")};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),e.jsxs(R,{title:"Shape Match",score:l,children:[e.jsx($,{feedback:c}),s&&e.jsx("div",{className:"flex-shrink-0 mb-1",children:e.jsxs("div",{className:"flex items-center justify-center gap-1 bg-gray-100 rounded-full py-0.5 px-2",children:[e.jsx("div",{className:`w-6 h-6 ${s.color} rounded flex items-center justify-center text-white text-sm`,children:s.emoji}),e.jsx("span",{className:"text-base md:text-lg font-bold text-text-primary",children:s.name}),e.jsx("button",{onClick:()=>m(`Find the ${s.name}`),className:"w-6 h-6 bg-primary/20 rounded-full flex items-center justify-center text-sm hover:bg-primary/30 transition-colors","aria-label":"Repeat instruction",children:"ðŸ”Š"})]})}),e.jsx("div",{className:"flex-1 flex items-center justify-center min-h-0 w-full",children:e.jsx("div",{className:`
          grid gap-1 w-full h-full max-h-full
          ${p==="portrait"?"grid-cols-2 grid-rows-2":"grid-cols-4 grid-rows-1"}
        `,children:o.map(t=>e.jsxs(G,{onClick:()=>u(t),shake:d===t.id,children:[e.jsx("div",{className:`w-12 h-12 ${t.color} rounded-xl flex items-center justify-center text-white text-4xl mx-auto`,children:t.emoji}),e.jsx("span",{children:t.name})]},t.id))})}),r&&e.jsx(I,{})]})}export{q as default};
